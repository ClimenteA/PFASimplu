<style>
    .none {
        display: none;
    }
</style>


<main class="container">

    <hgroup class="container">
        <h1>Adauga declaratii/documente</h1>
        <h2>
            Adauga declaratiile depuse la ANAF si dovezile de plata impozite.
        </h2>
    </hgroup>


    <form action="/adauga-declaratii" method="POST" enctype="multipart/form-data">

        <article>

            <h5 style="color: var(--secondary);">Adauga declaratii/documente</h5>

            <div class="grid">

                <label for="data">
                    Tip Document
                    <input list="tipdoc" type="text" id="tip_document" name="tip_document" required>

                    <datalist id="tipdoc">
                        <option value="Declaratie unica (212)"></option>
                        <option value="Dovada incarcare Declaratie 212"></option>
                        <option value="Dovada plata impozite"></option>
                    </datalist>

                </label>

                <label for="data">
                    Data document
                    <input type="date" id="data" name="data" required>
                    <small></small>
                </label>


                <label class="none" id="declaratie_label_year" for="declaratie_pentru_anul">
                    Declaratie pentru anul
                    <input list="aniinregistrati" type="number" id="declaratie_pentru_anul"
                        name="declaratie_pentru_anul" required>

                    <datalist id="aniinregistrati">
                        {{range .AniInregistrati}}
                        <option value="{{.}}">{{.}}</option>
                        {{end}}
                    </datalist>

                </label>

            </div>

            <div class="grid">

                <label class="none" id="plata_anaf_label_sum" for="plata_anaf">
                    Suma Platita catre ANAF
                    <input type="number" id="plata_anaf" name="plata_anaf" value="0" required>
                </label>

                <label class="none" id="plata_anaf_label_year" for="plata_pentru_anul">
                    Plata pentru anul
                    <input list="regyears" type="number" id="plata_pentru_anul" name="plata_pentru_anul" required>

                    <datalist id="regyears">
                        {{range .AniInregistrati}}
                        <option value="{{.}}">{{.}}</option>
                        {{end}}
                    </datalist>

                </label>

            </div>


            <label for="file">
                Incarca document
                <input type="file" id="file" name="fisier" required>
            </label>

            <button type="submit">ADAUGA</button>

        </article>

    </form>

</main>


<script>

    window.onload = event => {
        let tipDoc = document.getElementById("tip_document");
        let dataDoc = document.getElementById("data");
        let plata_anaf_label_sum = document.getElementById("plata_anaf_label_sum");
        let plata_anaf_label_year = document.getElementById("plata_anaf_label_year");
        let declaratie_label_year = document.getElementById("declaratie_label_year");
        let declaratie_pentru_anul = document.getElementById("declaratie_pentru_anul");
        let plata_pentru_anul = document.getElementById("plata_pentru_anul");

        dataDoc.addEventListener("change", event => {
            let currentYear = dataDoc.value.slice(0, 4);
            let previousYear = String(parseInt(currentYear) - 1);

            if (tipDoc.value == "Dovada plata impozite") {
                declaratie_pentru_anul.value = previousYear;
                plata_pentru_anul.value = previousYear;
            } else {
                declaratie_pentru_anul.value = currentYear;
                plata_pentru_anul.value = currentYear;
            }

        }, false);

        tipDoc.addEventListener("change", event => {
            if (event.target.value == "Dovada plata impozite") {
                plata_anaf_label_sum.classList.remove("none");
                plata_anaf_label_year.classList.remove("none");
            }
            else if (event.target.value == "Declaratie unica (212)" || event.target.value == "Dovada incarcare Declaratie 212") {
                declaratie_label_year.classList.remove("none");
            }
            else {
                plata_anaf_label_sum.classList.add("none");
                plata_anaf_label_year.classList.add("none");
                declaratie_label_year.classList.add("none");
            }
        }, false);

    }

</script>